---
output:
  md_document:
    variant: gfm+tex_math_dollars
    preserve_yaml: false
editor_options:
  markdown:
    mode: gfm
    extensions: +tex_math_dollars+raw_tex
---
<!-- README.md is generated from README.Rmd. Please edit that file -->


```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "",
  fig.path = "man/figures/README-",
  out.width = "100%",
  message = FALSE,
  warning = FALSE
)
```

# chensus <img src="man/figures/logo.png" align="right" width="10%" />

[![R-CMD-check](https://github.com/afds-bl/chensus/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/afds-bl/chensus/actions/workflows/R-CMD-check.yaml)
 [![License: GPL v3](https://img.shields.io/badge/license-GPL--3-blue.svg)](https://www.gnu.org/licenses/gpl-3.0.en.html)

`chensus` is an R package for estimating populations from surveys conducted by
the Swiss Federal Statistical Office (FSO), sepcificially:

-   structural survey: *Strukturerhebung* (SE) / *relevé structurel* (RS),
-   mobility and transport survey: *Mikrozensus Mobilität und Verkehr*
    (MZMV) / *Microrecensement mobilité et transports* (MRMT).

It implements closed-form formulas for confidence intervals as described in the FSO’s methodological reports for the [structural survey](https://www.bfs.admin.ch/bfs/en/home/services/research/methodological-reports.assetdetail.11187024.html) and [mobility and transport survey](https://www.bfs.admin.ch/bfs/fr/home/statistiques/mobilite-transports/enquetes/mzmv.assetdetail.24266729.html). For mathematical details, see the [Method vignette](articles/method.html).

## Installation

You can install the development version from GitHub with:

```{r eval = FALSE}
remotes::install_github("afds-bl/chensus")
```

## Usage

### Structural survey (SE/RS)

Estimate population totals by gender:

```{r example1}
library(chensus)

se_total(
  data = nhanes,
  weight = "weights",
  strata = "strata",
  group_vars = "gender"
)
```

Estimate average household size:

```{r}
se_mean_num(
  data = nhanes,
  variable = household_size,
  weight = weights,
  strata = strata
)
```

Estimate population proportions by household size:

```{r example2}
se_mean_cat(
  data = nhanes,
  variable = household_size,
  weight = weights,
  strata = strata
)
```

### Mobility and Transport Survey (MZMV/MRMT)

Estimate average annual household and family incomes:

```{r example3}
mzmv_mean(
  data = nhanes,
  variable = c("annual_household_income", "annual_family_income"),
  weight = "weights"
)
```

Estimate by group (e.g., gender, interview language):

``` {r}
mzmv_mean_map(
  data = nhanes,
  variable = c("annual_household_income", "annual_family_income"),
  group_vars = c("gender", "interview_lang"),
  weight = "weights"
)
```

## Documentation

- `?nhanes`: inspect the example dataset
- `vignette("chensus")`: detailed examples
- `vignette("Method")`: mathematical background
- `?se_total`, `?mzmv_mean`, etc.: function documentation

## License

Distributed under the GPL-3 License. See `LICENSE` for more information.

## Contact

[Souad Guemghar](mailto:souad.guemghar@bl.ch)

Amt für Daten und Statistik, Basel-Landschaft

## Acknowledgments

This package is an extension of
[vhatbfs](https://github.com/gibonet/vhatbfs) by Sandro Burri, which estimates the confidence intervals of totals for the structural survey. Many thanks to Sandro for the foundational work and support.

## Citation

```{r eval = FALSE}
utils::citation("chensus")
```


```{r echo = FALSE}
utils::citation("chensus")
```
