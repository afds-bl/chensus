---
output:
  md_document:
    variant: gfm+tex_math_dollars
    preserve_yaml: false
editor_options:
  markdown:
    mode: gfm
    extensions: +tex_math_dollars+raw_tex
---
<!-- README.md is generated from README.Rmd. Please edit that file -->


```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "",
  fig.path = "man/figures/README-",
  out.width = "100%",
  message = FALSE,
  warning = FALSE
)
```

# chensus <img src="man/figures/logo.png" align="right" width="10%" />

[![R-CMD-check](https://github.com/afds-bl/chensus/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/afds-bl/chensus/actions/workflows/R-CMD-check.yaml)
 [![License: GPL v3](https://img.shields.io/badge/license-GPL--3-blue.svg)](https://www.gnu.org/licenses/gpl-3.0.en.html)

The `chensus` package estimates population frequencies, means,
proportions and confidence intervals from surveys conducted by
the Federal Statistical Office (FSO):

-   structural survey: *Strukturerhebung* (SE) / *relevé structurel* (RS),
-   mobility and transport survey: *Mikrozensus Mobilität und Verkehr*
    (MZMV) / *Microrecensement mobilité et transports* (MRMT).
    
`chensus` implements closed-form formulas of confidence interval estimates as outlined in FSO’s methodological reports for the [structural survey](https://www.bfs.admin.ch/bfs/en/home/services/research/methodological-reports.assetdetail.11187024.html) and [mobility and transport survey](https://www.bfs.admin.ch/bfs/fr/home/statistiques/mobilite-transports/enquetes/mzmv.assetdetail.24266729.html). For mathematical details, see the [Method vignette](articles/method.html).

# Installation

```{r eval = FALSE}
# Install from GitHub
remotes::install_github("afds-bl/chensus")
```

# Usage


## Structural survey (*Strukturerhebung* / *relevé structurel*)

Here we estimate the male and female populations of the built-in `nhanes` dataset, which contains a subset of data from the [National Health and Nutrition Examination Survey](https://wwwn.cdc.gov/Nchs/Nhanes/2015-2016/DEMO_I.htm) (more with `?nhanes`).

```{r example1}
library(chensus)

se_estimate_total(
  data = nhanes,
  weight = "weights",
  strata = "strata",
  condition = "gender"
)
```

We can also estimate the average household size:

```{r}
se_mean_num(
  data = nhanes,
  variable = "household_size",
  weight = "weights",
  strata = "strata"
  )
```

and the proportion of the population for each household size:
```{r example2}
library(chensus)

se_mean_cat(
  data = nhanes, 
  variable = "household_size", 
  weight = "weights",
  strata = "strata"
  )
```

## Mobility and Transport Survey (MZMV/MRMT)

Here we estimate the annual household and family incomes:

```{r example3}
library(chensus)

mzmv_mean(
  data = nhanes,
  variable = c("annual_household_income", "annual_family_income"),
  weight = "weights"
)
```

We can also use the `mzmv_mean_map()` function with a set of conditions:

``` {r}
library(chensus)

variable <- c("annual_household_income", "annual_family_income")
condition <- c("gender", "interview_lang")

mzmv_mean_map(
  data = nhanes,
  variable = variable,
  condition = condition,
  weight = "weights"
)
```

# License

Distributed under the GPL-3 License. See `LICENSE` for more information.

# Contact

[Souad Guemghar](mailto:souad.guemghar@bl.ch)

# Acknowledgments

This package is an extension of
[vhatbfs](https://github.com/gibonet/vhatbfs) by Sandro Burri, a package
to estimate the confidence intervals of *Strukturerhebung* / *relevé
structurel*. Many thanks Sandro for the great work and support!

# Citation

```{r eval = FALSE}
utils::citation("chensus")
```


```{r echo = FALSE}
utils::citation("chensus")
```
